{% extends 'user/layout.html' %}
{% block title %}Budget | EMI Analyzer{% endblock %}
{% block content %}
<div class="mf-page-head"><div><h4 class="mb-1">Budget Planner</h4><p class="mb-0">Track expenses and optimize savings after loan EMI and card obligations.</p></div></div>
<div class="row g-4">
<div class="col-lg-6"><div class="card mf-form-card"><div class="card-body p-4"><form method="post">{% csrf_token %}
<div class="mb-3"><label class="form-label">Grocery</label><input type="number" class="form-control" name="grocery" min="0" value="{{ budget.grocery|default:0 }}" required></div>
<div class="mb-3"><label class="form-label">Rent</label><input type="number" class="form-control" name="rent" min="0" value="{{ budget.rent|default:0 }}" required></div>
<div class="mb-3"><label class="form-label">Transport</label><input type="number" class="form-control" name="transport" min="0" value="{{ budget.transport|default:0 }}" required></div>
<div class="mb-3"><label class="form-label">Entertainment</label><input type="number" class="form-control" name="entertainment" min="0" value="{{ budget.entertainment|default:0 }}" required></div>
<button type="submit" class="btn btn-primary">Save Budget</button></form></div></div></div>
<div class="col-lg-6"><div class="card mf-panel-card h-100"><div class="card-body">
<h5 class="mb-3">Budget Insights</h5>
<p><strong>Total Expenses:</strong> Rs. {{ total_expenses|floatformat:0 }}</p>
<p><strong>Card Obligation (Current Month):</strong> Rs. {{ card_due_estimate|floatformat:0 }}</p>
<p><strong>Income After Debt Obligations:</strong> Rs. {{ remaining_after_obligations|default:remaining_after_emi|floatformat:0 }}</p>
<p><strong>Savings After Obligations + Budget:</strong> Rs. {{ savings_after_obligations|default:savings_after_emi|floatformat:0 }}</p>
<p><strong>Debt Manageability:</strong> {% if emi_manageable %}<span class="text-success">Manageable{% else %}<span class="text-danger">High Risk{% endif %}</span></p>
{% if overspending %}<div class="alert alert-danger">Overspending detected.</div>{% else %}<div class="alert alert-success">Spending is under control.</div>{% endif %}
<h6 class="mt-3">Suggestions</h6><ul class="ps-3 mb-0">{% for item in suggestions %}<li>{{ item }}</li>{% empty %}<li>No suggestions.</li>{% endfor %}</ul>
</div></div></div>
</div>
{% endblock %}
